## 세션과 쿠키의 차이는 무엇인가요?
### 쿠키 (only 쿠키)
* 쿠키는 서버에서 사용자 브라우저 (클라이언트)로 전송하는 작은 데이터
* 브라우저는 서버에서 받은 데이터 (Cookie)를 저장해둔 뒤 동일한 서버로 재요청 시 제공받았던 데이터를 함께 전송
* key-value 형태로 저장됨
* 쿠키는 도메인에 따라 제한이 된다. 예를 들어 유튜브가 준 쿠키는 유튜브에만 보내지게 된다. (SameSite를 설정한 경우)
* 쿠키는 유효 기간 (MaxAge)이 존재한다. 이는 서버가 결정한다.
* 쿠키는 인증 말고도 여러 가지 정보 (ex: 페이지 언어)도 저장할 수 있다.
* 인증/인가를 위한 추가적인 데이터 저장이 필요 없다.
* 사용자의 주요 정보 (ID, PW 등)를 매번 담아야 하기에 보안상의 문제가 있다.
  * HttpOnly, SameSite, Secure 등으로 보안성을 약간 향상시킬 수 있다.
### 세션 (with 쿠키)
* 서버에게 클라이언트가 누구인지 알려주는 방법
* 유저가 로그인을 하면 서버는 `세션 DB`에 유저를 생성한다.
* 세션에는 `별도의 ID`가 있고, 이 ID는 쿠키를 통해 브라우저로 돌아오고 저장된다. (사용자에 대한 ID, PW가 기록되지 않아도 되어 쿠키만 사용할 때 보다 좀 더 보안성이 좋다.)
* 브라우저는 세션 ID를 갖고 있는 쿠키를 서버에게 보낸다. (즉, 쿠키는 `세션 ID를 전달하기 위한 매개체`이다.)
* 서버는 들어오는 쿠키 안에 있는 `세션 ID로 세션 DB를 확인`한다. 이후 서버는 클라이언트를 식별한다.
* 즉, 서버는 `로그인 한 유저들의 모든 세션 ID를 DB에 저장`해야 한다. 이는 유저가 늘어남에 따라 DB 리소스가 더 필요함을 의미한다.
* 세션 방식을 이용하면 특정 유저를 쫓아내고 싶을 때 세션을 삭제하면 된다. (이는 인스타그램에서 로그인 된 기기의 로그아웃, 넷플릭스의 계정 공유 등에서 쓰인다.)
* 그러나 `유저가 늘어날수록 DB가 커진다`는 문제가 있고, 이때 Redis를 사용하기도 한다.
* 세션 하이재킹 (Session Hi-jacking) 등의 해킹 위험성이 존재한다.
## 세션 과정을 설명해주세요.
쿠키를 활용한 방식의 과정은 아래와 같다.
1. 유저 로그인, 세션 DB 유저 생성
2. 세션 ID 할당, 쿠키에 삽입하여 서버가 브라우저에게 전달
3. 브라우저가 접속할 때 마다 해당 쿠키를 서버에 전달
4. 서버는 쿠키 안에 있는 세션 ID로 세션 DB를 확인, 인증 완료
    * HTTP 요청 메시지의 JSESSIONID 쿠키값 등을 확인함
## 쿠키를 사용할 수 없을 때 세션을 대신 사용할 수 있을까요?
가능하긴 하다.

쿠키를 활용할 수 없다면 가장 많이 활용되는 방식은 `URL 등에 매개변수로 세션ID를 붙이는 방법 (URL ReWrite)`인데, `URL에 세션 ID가 직접적으로 노출`되는 단점이 있다. (그럼에도 유저의 실제 정보는 서버에 저장되어 있긴 하다.) 

아래는 JSP에서 자체적으로 URL에 세션 ID를 기록한 방법이다.
```jsp
<%@ page contentType="text/html; charset=utf-8" session="true"%>
<html>
<head>
</head>
<body>
<h1>로그인 페이지</h1>
<%
     session.setAttribute("isLogin", true);
%>
<form action="http://localhost/rewrite.jsp;JSESSIONID=<%= session.getId() %>" >            
     <input type="submit">
</form>
</body>
</html>
```
## Reference
* [세션 vs 토큰 vs 쿠키? 기초개념 잡아드림. 10분 순삭!](https://www.youtube.com/watch?v=tosLBcAX1vk)
* [[CS/보안 기초] (1) 쿠키(cookie)와 세션(session)의 차이](https://hec-ker.tistory.com/368#2.2.%20%EC%84%B8%EC%85%98%20(Session))
* [[서블릿/JSP] 쿠키가 차단되는 환경일때 SESSIONID URL로 넘기기 (URL REWRITE)](https://dololak.tistory.com/579)
